<table mat-table [dataSource]="dataSource" class="mat-elevation-z8 table" matSort (matSortChange)="sortChange($event)">
  @for (column of COLUMNS; track column.key; let index = $index) {
  <ng-container [matColumnDef]="column.name">
    @if (column.sortable) {
    <th mat-header-cell [mat-sort-header]="column.name" *matHeaderCellDef>
      <span translate>{{ column.header }}</span>
    </th>
    } @else {
    <th mat-header-cell *matHeaderCellDef>
      <span translate>{{ column.header }}</span>
    </th>
    }

    <td mat-cell *matCellDef="let value">
      @switch (column.type) { @case ('string') {
      {{ value[column.key] }}
      } @case ('checkbox') {
      <mat-checkbox
        [checked]="value[column.key]"
        (change)="updateCheckboxValue(value.id, $event)"
        [disabled]="value.id === currentValue"
        color="primary"
      ></mat-checkbox>
      } @case ('workgroups') {
      <div
        [matTooltip]="column.hasTooltip ? formatWorkgroupsTooltip(value[column.key]) : ''"
        matTooltipClass="cell-tooltip"
        matTooltipPosition="left"
      >
        <mat-chip-set>
          @for (workgroup of getUserWorkgroups(value); track workgroup.id) {
          <asset-sg-chip [text]="workgroup.name"></asset-sg-chip>
          } @if (value.roles.size > WORKGROUP_DISPLAY_COUNT) {
          <asset-sg-chip [text]="'+' + (value.roles.size - WORKGROUP_DISPLAY_COUNT)"></asset-sg-chip>
          }
        </mat-chip-set>
      </div>

      } @case ('action') {
      <button [routerLink]="[value[column.key]]">
        <svg-icon [key]="column.icon ?? 'edit'"></svg-icon>
      </button>
      } }
    </td>
  </ng-container>
  }
  <tr mat-header-row *matHeaderRowDef="cols; sticky: true" class="table__header"></tr>
  <tr mat-row *matRowDef="let row; columns: cols"></tr>
</table>
<mat-paginator [pageSizeOptions]="[25, 50, 100]" [showFirstLastButtons]="true"></mat-paginator>
