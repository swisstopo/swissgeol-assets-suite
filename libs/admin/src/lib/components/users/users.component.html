<div>
  @if (selectedUser) {
  <asset-sg-user-edit [user]="selectedUser" [workgroups]="workgroups"></asset-sg-user-edit>
  }

  <table mat-table [dataSource]="users" class="mat-elevation-z8 table">
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let user">{{ user.email }}</td>
    </ng-container>
    <ng-container matColumnDef="workgroups">
      <th mat-header-cell *matHeaderCellDef>Workgroups</th>
      <td mat-cell *matCellDef="let user">
        @for (workgroup of user.workgroups; track workgroup.workgroupId) {
        <div>{{ workgroup.workgroup.name }}: {{ workgroup.role }}</div>
        }
      </td>
    </ng-container>
    <ng-container matColumnDef="isAdmin">
      <th mat-header-cell *matHeaderCellDef>Admin</th>

      <td mat-cell *matCellDef="let user">
        <mat-checkbox [checked]="user.isAdmin" (change)="update(user, $event)"></mat-checkbox>
      </td>
    </ng-container>
    <ng-container matColumnDef="languages">
      <th mat-header-cell *matHeaderCellDef>Sprache</th>
      <td mat-cell *matCellDef="let user">{{ user.lang }}</td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Aktionen</th>
      <td mat-cell *matCellDef="let user">
        <button mat-button (click)="edit(user)">Editieren</button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="COLUMNS; sticky: true" class="table-header"></tr>
    <tr mat-row *matRowDef="let row; columns: COLUMNS"></tr>
  </table>
</div>
